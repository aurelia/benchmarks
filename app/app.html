<template>
  <require from="./result-set"></require>

  <nav class="navbar navbar-fixed-top navbar-light bg-faded">
    <span class="navbar-brand">Benchmarks</span>

    <form class="form-inline navbar-form pull-left">
      <input type="text" class="form-control" placeholder="Search" ref="search">
      <button class="btn btn-primary" click.delegate="run()" disabled.bind="!selectedDefinitions.length">Run</button>
    </form>

    <form class="form-inline navbar-form pull-right">
      <input type="text" class="form-control" placeholder="Tag Name" ref="tagInput">
      <button class="btn btn-success-outline" type="submit"
              click.delegate="tag(tagInput.value)"
              disabled.bind="isTagging || !tagInput.value.trim().length || !selectedDefinitions.length">Tag
      </button>
    </form>
  </nav>

  <div class="container m-t-lg p-t">
    <div class="table-responsive">
      <table class="table table-striped table-sm table-hover">
        <thead>
          <tr>
            <th>
              <input type="checkbox" checked.bind="allSelected"
                     indeterminate.bind="selectedDefinitions.length && selectedDefinitions.length < definitions.length">
            </th>
            <th>Benchmark</th>
            <th>Results</th>
          </tr>
        </thead>
        <tbody>
          <tr repeat.for="definition of definitions | filterDefinitions:search.value"
              click.trigger="$parent.definitionClicked(definition, $event)"
              class.bind="definition === $parent.coordinator.active ? 'table-info' : ''"
              style="cursor: pointer">
            <td>
              <!-- selected -->
              <input type="checkbox" model.bind="definition" checked.one-way="$parent.selectedDefinitions">
            </td>
            <td>
              <!-- name -->
              <strong>${definition.name}</strong>
              <small class="text-muted">${definition.type}</small>
            </td>
            <td>
              <!-- results -->
              <div if.bind="$parent.results[definition.name]">
                <div repeat.for="userAgent of $parent.userAgents">
                  <small class="user-agent text-muted">${userAgent}:</small>
                  <result-set results.bind="$parent.$parent.results[$parent.definition.name][userAgent]"></result-set>
                </div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</template>
